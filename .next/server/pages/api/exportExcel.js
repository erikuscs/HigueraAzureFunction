"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/exportExcel";
exports.ids = ["pages/api/exportExcel"];
exports.modules = {

/***/ "@azure/identity?e5d3":
/*!**********************************!*\
  !*** external "@azure/identity" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("@azure/identity");

/***/ }),

/***/ "@azure/monitor-query":
/*!***************************************!*\
  !*** external "@azure/monitor-query" ***!
  \***************************************/
/***/ ((module) => {

module.exports = require("@azure/monitor-query");

/***/ }),

/***/ "applicationinsights":
/*!**************************************!*\
  !*** external "applicationinsights" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("applicationinsights");

/***/ }),

/***/ "exceljs":
/*!**************************!*\
  !*** external "exceljs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("exceljs");

/***/ }),

/***/ "express-rate-limit":
/*!*************************************!*\
  !*** external "express-rate-limit" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("express-rate-limit");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "@azure/identity?132f":
/*!**********************************!*\
  !*** external "@azure/identity" ***!
  \**********************************/
/***/ ((module) => {

module.exports = import("@azure/identity");;

/***/ }),

/***/ "@azure/keyvault-secrets":
/*!******************************************!*\
  !*** external "@azure/keyvault-secrets" ***!
  \******************************************/
/***/ ((module) => {

module.exports = import("@azure/keyvault-secrets");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2FexportExcel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2FexportExcel.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2FexportExcel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2FexportExcel.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/exportExcel.js */ \"(api)/./pages/api/exportExcel.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/exportExcel\",\n        pathname: \"/api/exportExcel\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_exportExcel_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmV4cG9ydEV4Y2VsJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZleHBvcnRFeGNlbC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN1RDtBQUN2RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsc0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHNEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2hpZ3VlcmFhenVyZWZ1bmN0aW9uLz9mYmZhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZXhwb3J0RXhjZWwuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9leHBvcnRFeGNlbFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2V4cG9ydEV4Y2VsXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2FexportExcel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2FexportExcel.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/config.ts":
/*!***********************!*\
  !*** ./lib/config.ts ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultMonitoringConfig: () => (/* binding */ defaultMonitoringConfig),\n/* harmony export */   defaultSecurityConfig: () => (/* binding */ defaultSecurityConfig),\n/* harmony export */   getSecretConfig: () => (/* binding */ getSecretConfig)\n/* harmony export */ });\n/* harmony import */ var _azure_identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @azure/identity */ \"@azure/identity?132f\");\n/* harmony import */ var _azure_keyvault_secrets__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @azure/keyvault-secrets */ \"@azure/keyvault-secrets\");\n/* harmony import */ var _monitoringService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./monitoringService */ \"(api)/./lib/monitoringService.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_azure_identity__WEBPACK_IMPORTED_MODULE_0__, _azure_keyvault_secrets__WEBPACK_IMPORTED_MODULE_1__]);\n([_azure_identity__WEBPACK_IMPORTED_MODULE_0__, _azure_keyvault_secrets__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nconst credential = new _azure_identity__WEBPACK_IMPORTED_MODULE_0__.DefaultAzureCredential();\nlet secretClient = null;\n// Initialize Key Vault client\nasync function initializeKeyVault() {\n    if (!secretClient && process.env.KEY_VAULT_URL) {\n        try {\n            secretClient = new _azure_keyvault_secrets__WEBPACK_IMPORTED_MODULE_1__.SecretClient(process.env.KEY_VAULT_URL, credential);\n        } catch (error) {\n            (0,_monitoringService__WEBPACK_IMPORTED_MODULE_2__.trackException)(error, {\n                service: \"KeyVault\"\n            });\n            throw error;\n        }\n    }\n}\n// Cache for secrets to reduce Key Vault calls\nconst secretsCache = new Map();\nconst CACHE_TTL = 3600000; // 1 hour\nasync function getSecretConfig(secretName) {\n    // Check cache first\n    const cached = secretsCache.get(secretName);\n    if (cached && Date.now() < cached.expiresAt) {\n        return cached.value;\n    }\n    // If not in cache or expired, get from Key Vault\n    try {\n        await initializeKeyVault();\n        if (!secretClient) {\n            return process.env[secretName];\n        }\n        const secret = await secretClient.getSecret(secretName);\n        // Update cache\n        secretsCache.set(secretName, {\n            value: secret.value,\n            expiresAt: Date.now() + CACHE_TTL\n        });\n        return secret.value;\n    } catch (error) {\n        (0,_monitoringService__WEBPACK_IMPORTED_MODULE_2__.trackException)(error, {\n            operation: \"getSecretConfig\",\n            secretName\n        });\n        // Fallback to environment variable\n        return process.env[secretName];\n    }\n}\nconst defaultSecurityConfig = {\n    maxRequestsPerMinute: 60,\n    jwtSecret: process.env.JWT_SECRET || \"your-default-secret\",\n    allowedOrigins: (process.env.CORS_ALLOWED_ORIGINS || \"\").split(\",\")\n};\nconst defaultMonitoringConfig = {\n    logLevel: process.env.LOG_LEVEL || \"info\",\n    sampleRate: Number(process.env.MONITORING_SAMPLE_RATE || \"1\")\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5RDtBQUNGO0FBQ0Y7QUFFckQsTUFBTUcsYUFBYSxJQUFJSCxtRUFBc0JBO0FBQzdDLElBQUlJLGVBQW9DO0FBRXhDLDhCQUE4QjtBQUM5QixlQUFlQztJQUNYLElBQUksQ0FBQ0QsZ0JBQWdCRSxRQUFRQyxHQUFHLENBQUNDLGFBQWEsRUFBRTtRQUM1QyxJQUFJO1lBQ0FKLGVBQWUsSUFBSUgsaUVBQVlBLENBQUNLLFFBQVFDLEdBQUcsQ0FBQ0MsYUFBYSxFQUFFTDtRQUMvRCxFQUFFLE9BQU9NLE9BQU87WUFDWlAsa0VBQWNBLENBQUNPLE9BQWdCO2dCQUFFQyxTQUFTO1lBQVc7WUFDckQsTUFBTUQ7UUFDVjtJQUNKO0FBQ0o7QUFhQSw4Q0FBOEM7QUFDOUMsTUFBTUUsZUFBZSxJQUFJQztBQUN6QixNQUFNQyxZQUFZLFNBQVMsU0FBUztBQUU3QixlQUFlQyxnQkFBZ0JDLFVBQWtCO0lBQ3BELG9CQUFvQjtJQUNwQixNQUFNQyxTQUFTTCxhQUFhTSxHQUFHLENBQUNGO0lBQ2hDLElBQUlDLFVBQVVFLEtBQUtDLEdBQUcsS0FBS0gsT0FBT0ksU0FBUyxFQUFFO1FBQ3pDLE9BQU9KLE9BQU9LLEtBQUs7SUFDdkI7SUFFQSxpREFBaUQ7SUFDakQsSUFBSTtRQUNBLE1BQU1oQjtRQUNOLElBQUksQ0FBQ0QsY0FBYztZQUNmLE9BQU9FLFFBQVFDLEdBQUcsQ0FBQ1EsV0FBVztRQUNsQztRQUVBLE1BQU1PLFNBQVMsTUFBTWxCLGFBQWFtQixTQUFTLENBQUNSO1FBRTVDLGVBQWU7UUFDZkosYUFBYWEsR0FBRyxDQUFDVCxZQUFZO1lBQ3pCTSxPQUFPQyxPQUFPRCxLQUFLO1lBQ25CRCxXQUFXRixLQUFLQyxHQUFHLEtBQUtOO1FBQzVCO1FBRUEsT0FBT1MsT0FBT0QsS0FBSztJQUN2QixFQUFFLE9BQU9aLE9BQU87UUFDWlAsa0VBQWNBLENBQUNPLE9BQWdCO1lBQzNCZ0IsV0FBVztZQUNYVjtRQUNKO1FBQ0EsbUNBQW1DO1FBQ25DLE9BQU9ULFFBQVFDLEdBQUcsQ0FBQ1EsV0FBVztJQUNsQztBQUNKO0FBRU8sTUFBTVcsd0JBQXdDO0lBQ2pEQyxzQkFBc0I7SUFDdEJDLFdBQVd0QixRQUFRQyxHQUFHLENBQUNzQixVQUFVLElBQUk7SUFDckNDLGdCQUFnQixDQUFDeEIsUUFBUUMsR0FBRyxDQUFDd0Isb0JBQW9CLElBQUksRUFBQyxFQUFHQyxLQUFLLENBQUM7QUFDbkUsRUFBRTtBQUVLLE1BQU1DLDBCQUE0QztJQUNyREMsVUFBVzVCLFFBQVFDLEdBQUcsQ0FBQzRCLFNBQVMsSUFBSTtJQUNwQ0MsWUFBWUMsT0FBTy9CLFFBQVFDLEdBQUcsQ0FBQytCLHNCQUFzQixJQUFJO0FBQzdELEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oaWd1ZXJhYXp1cmVmdW5jdGlvbi8uL2xpYi9jb25maWcudHM/MTI4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWZhdWx0QXp1cmVDcmVkZW50aWFsIH0gZnJvbSAnQGF6dXJlL2lkZW50aXR5JztcbmltcG9ydCB7IFNlY3JldENsaWVudCB9IGZyb20gJ0BhenVyZS9rZXl2YXVsdC1zZWNyZXRzJztcbmltcG9ydCB7IHRyYWNrRXhjZXB0aW9uIH0gZnJvbSAnLi9tb25pdG9yaW5nU2VydmljZSc7XG5cbmNvbnN0IGNyZWRlbnRpYWwgPSBuZXcgRGVmYXVsdEF6dXJlQ3JlZGVudGlhbCgpO1xubGV0IHNlY3JldENsaWVudDogU2VjcmV0Q2xpZW50IHwgbnVsbCA9IG51bGw7XG5cbi8vIEluaXRpYWxpemUgS2V5IFZhdWx0IGNsaWVudFxuYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZUtleVZhdWx0KCkge1xuICAgIGlmICghc2VjcmV0Q2xpZW50ICYmIHByb2Nlc3MuZW52LktFWV9WQVVMVF9VUkwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNlY3JldENsaWVudCA9IG5ldyBTZWNyZXRDbGllbnQocHJvY2Vzcy5lbnYuS0VZX1ZBVUxUX1VSTCwgY3JlZGVudGlhbCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0cmFja0V4Y2VwdGlvbihlcnJvciBhcyBFcnJvciwgeyBzZXJ2aWNlOiAnS2V5VmF1bHQnIH0pO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjdXJpdHlDb25maWcge1xuICAgIG1heFJlcXVlc3RzUGVyTWludXRlOiBudW1iZXI7XG4gICAgand0U2VjcmV0OiBzdHJpbmc7XG4gICAgYWxsb3dlZE9yaWdpbnM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vbml0b3JpbmdDb25maWcge1xuICAgIGxvZ0xldmVsOiAnZXJyb3InIHwgJ3dhcm4nIHwgJ2luZm8nIHwgJ2RlYnVnJztcbiAgICBzYW1wbGVSYXRlOiBudW1iZXI7XG59XG5cbi8vIENhY2hlIGZvciBzZWNyZXRzIHRvIHJlZHVjZSBLZXkgVmF1bHQgY2FsbHNcbmNvbnN0IHNlY3JldHNDYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCB7IHZhbHVlOiBzdHJpbmc7IGV4cGlyZXNBdDogbnVtYmVyIH0+KCk7XG5jb25zdCBDQUNIRV9UVEwgPSAzNjAwMDAwOyAvLyAxIGhvdXJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlY3JldENvbmZpZyhzZWNyZXROYW1lOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD4ge1xuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XG4gICAgY29uc3QgY2FjaGVkID0gc2VjcmV0c0NhY2hlLmdldChzZWNyZXROYW1lKTtcbiAgICBpZiAoY2FjaGVkICYmIERhdGUubm93KCkgPCBjYWNoZWQuZXhwaXJlc0F0KSB7XG4gICAgICAgIHJldHVybiBjYWNoZWQudmFsdWU7XG4gICAgfVxuXG4gICAgLy8gSWYgbm90IGluIGNhY2hlIG9yIGV4cGlyZWQsIGdldCBmcm9tIEtleSBWYXVsdFxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGluaXRpYWxpemVLZXlWYXVsdCgpO1xuICAgICAgICBpZiAoIXNlY3JldENsaWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3MuZW52W3NlY3JldE5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2VjcmV0ID0gYXdhaXQgc2VjcmV0Q2xpZW50LmdldFNlY3JldChzZWNyZXROYW1lKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBjYWNoZVxuICAgICAgICBzZWNyZXRzQ2FjaGUuc2V0KHNlY3JldE5hbWUsIHtcbiAgICAgICAgICAgIHZhbHVlOiBzZWNyZXQudmFsdWUhLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgQ0FDSEVfVFRMXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBzZWNyZXQudmFsdWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdHJhY2tFeGNlcHRpb24oZXJyb3IgYXMgRXJyb3IsIHtcbiAgICAgICAgICAgIG9wZXJhdGlvbjogJ2dldFNlY3JldENvbmZpZycsXG4gICAgICAgICAgICBzZWNyZXROYW1lXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBGYWxsYmFjayB0byBlbnZpcm9ubWVudCB2YXJpYWJsZVxuICAgICAgICByZXR1cm4gcHJvY2Vzcy5lbnZbc2VjcmV0TmFtZV07XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgZGVmYXVsdFNlY3VyaXR5Q29uZmlnOiBTZWN1cml0eUNvbmZpZyA9IHtcbiAgICBtYXhSZXF1ZXN0c1Blck1pbnV0ZTogNjAsXG4gICAgand0U2VjcmV0OiBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd5b3VyLWRlZmF1bHQtc2VjcmV0JyxcbiAgICBhbGxvd2VkT3JpZ2luczogKHByb2Nlc3MuZW52LkNPUlNfQUxMT1dFRF9PUklHSU5TIHx8ICcnKS5zcGxpdCgnLCcpXG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdE1vbml0b3JpbmdDb25maWc6IE1vbml0b3JpbmdDb25maWcgPSB7XG4gICAgbG9nTGV2ZWw6IChwcm9jZXNzLmVudi5MT0dfTEVWRUwgfHwgJ2luZm8nKSBhcyAnZXJyb3InIHwgJ3dhcm4nIHwgJ2luZm8nIHwgJ2RlYnVnJyxcbiAgICBzYW1wbGVSYXRlOiBOdW1iZXIocHJvY2Vzcy5lbnYuTU9OSVRPUklOR19TQU1QTEVfUkFURSB8fCAnMScpXG59OyJdLCJuYW1lcyI6WyJEZWZhdWx0QXp1cmVDcmVkZW50aWFsIiwiU2VjcmV0Q2xpZW50IiwidHJhY2tFeGNlcHRpb24iLCJjcmVkZW50aWFsIiwic2VjcmV0Q2xpZW50IiwiaW5pdGlhbGl6ZUtleVZhdWx0IiwicHJvY2VzcyIsImVudiIsIktFWV9WQVVMVF9VUkwiLCJlcnJvciIsInNlcnZpY2UiLCJzZWNyZXRzQ2FjaGUiLCJNYXAiLCJDQUNIRV9UVEwiLCJnZXRTZWNyZXRDb25maWciLCJzZWNyZXROYW1lIiwiY2FjaGVkIiwiZ2V0IiwiRGF0ZSIsIm5vdyIsImV4cGlyZXNBdCIsInZhbHVlIiwic2VjcmV0IiwiZ2V0U2VjcmV0Iiwic2V0Iiwib3BlcmF0aW9uIiwiZGVmYXVsdFNlY3VyaXR5Q29uZmlnIiwibWF4UmVxdWVzdHNQZXJNaW51dGUiLCJqd3RTZWNyZXQiLCJKV1RfU0VDUkVUIiwiYWxsb3dlZE9yaWdpbnMiLCJDT1JTX0FMTE9XRURfT1JJR0lOUyIsInNwbGl0IiwiZGVmYXVsdE1vbml0b3JpbmdDb25maWciLCJsb2dMZXZlbCIsIkxPR19MRVZFTCIsInNhbXBsZVJhdGUiLCJOdW1iZXIiLCJNT05JVE9SSU5HX1NBTVBMRV9SQVRFIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/config.ts\n");

/***/ }),

/***/ "(api)/./lib/middleware.ts":
/*!***************************!*\
  !*** ./lib/middleware.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ipRestriction: () => (/* binding */ ipRestriction),\n/* harmony export */   monitorPerformance: () => (/* binding */ monitorPerformance),\n/* harmony export */   rateLimiter: () => (/* binding */ rateLimiter),\n/* harmony export */   sanitizeInput: () => (/* binding */ sanitizeInput),\n/* harmony export */   validateContentType: () => (/* binding */ validateContentType),\n/* harmony export */   validateRequest: () => (/* binding */ validateRequest),\n/* harmony export */   withApiAuth: () => (/* binding */ withApiAuth)\n/* harmony export */ });\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ \"(api)/./lib/config.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_config__WEBPACK_IMPORTED_MODULE_0__]);\n_config__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// Server-only modules that will be imported conditionally\nlet rateLimit = null;\nlet trackExceptionFn = null;\n// Only import server-side modules when running on the server\nif (true) {\n    try {\n        rateLimit = __webpack_require__(/*! express-rate-limit */ \"express-rate-limit\");\n        const { trackException } = __webpack_require__(/*! ./monitoringService */ \"(api)/./lib/monitoringService.ts\");\n        trackExceptionFn = trackException;\n    } catch (error) {\n        console.error(\"Error importing server-side modules:\", error);\n    }\n}\n// Rate limiting middleware - will only work on server side\nconst rateLimiter =  true && rateLimit ? rateLimit({\n    windowMs: 60 * 1000,\n    max: _config__WEBPACK_IMPORTED_MODULE_0__.defaultSecurityConfig.maxRequestsPerMinute\n}) : (req, res, next)=>{\n    if (next) next();\n};\n// IP restriction middleware\nfunction ipRestriction(context) {\n    const allowedIPs = process.env.ALLOWED_IPS?.split(\",\") || [];\n    const clientIP = context.req?.headers[\"x-forwarded-for\"] || context.req?.connection.remoteAddress;\n    if (allowedIPs.length === 0) return true; // No IP restrictions\n    const isAllowed = allowedIPs.some((ip)=>{\n        if (ip.includes(\"*\")) {\n            const pattern = ip.replace(/\\./g, \"\\\\.\").replace(/\\*/g, \".*\");\n            return new RegExp(`^${pattern}$`).test(clientIP || \"\");\n        }\n        return ip === clientIP;\n    });\n    if (!isAllowed && \"undefined\" === \"undefined\" && trackExceptionFn) {\n        trackExceptionFn(new Error(\"IP restriction failed\"), {\n            clientIP: clientIP || \"unknown\",\n            source: context.executionContext.functionName\n        });\n    }\n    return isAllowed;\n}\n// Request validation middleware\nfunction validateRequest(context) {\n    const authHeader = context.req?.headers[\"authorization\"];\n    if (!authHeader) {\n        if ( true && trackExceptionFn) {\n            trackExceptionFn(new Error(\"Missing authorization header\"), {\n                source: context.executionContext.functionName\n            });\n        }\n        return false;\n    }\n    // Validate JWT token\n    try {\n        const token = authHeader.replace(\"Bearer \", \"\");\n        // Token validation logic would go here\n        // For now, just check if it exists\n        return !!token;\n    } catch (error) {\n        if ( true && trackExceptionFn) {\n            trackExceptionFn(error, {\n                source: context.executionContext.functionName\n            });\n        }\n        return false;\n    }\n}\n// Performance monitoring middleware\nfunction monitorPerformance(context, operationName) {\n    const startTime = Date.now();\n    return {\n        end: ()=>{\n            const duration = Date.now() - startTime;\n            if (context.log && typeof context.log.info === \"function\") {\n                context.log.info(\"Operation completed\", {\n                    name: operationName,\n                    duration,\n                    success: !context.res?.status || context.res.status < 400,\n                    functionName: context.executionContext?.functionName,\n                    invocationId: context.executionContext?.invocationId\n                });\n            }\n        }\n    };\n}\nfunction sanitizeInput(input) {\n    if (typeof input === \"string\") {\n        // Remove potential XSS content\n        return input.replace(/[<>]/g, \"\").replace(/javascript:/gi, \"\").replace(/on\\w+=/gi, \"\");\n    } else if (Array.isArray(input)) {\n        return input.map((item)=>sanitizeInput(item));\n    } else if (typeof input === \"object\" && input !== null) {\n        const sanitized = {};\n        for (const [key, value] of Object.entries(input)){\n            sanitized[key] = sanitizeInput(value);\n        }\n        return sanitized;\n    }\n    return input;\n}\nfunction validateContentType(context, expectedType) {\n    const contentType = context.req?.headers[\"content-type\"] || \"\";\n    return contentType.toLowerCase().includes(expectedType.toLowerCase());\n}\n// Auth middleware for Next.js API routes\nfunction withApiAuth(handler) {\n    return async (req, res)=>{\n        // Authentication logic would go here\n        // For now, just pass through\n        return handler(req, res);\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3JDLDZCQUE2QjtRQUM3QixPQUFPMEQsUUFBUTNELEtBQUtDO0lBQ3hCO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oaWd1ZXJhYXp1cmVmdW5jdGlvbi8uL2xpYi9taWRkbGV3YXJlLnRzPzk3OWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2VjdXJpdHlDb25maWcsIE1vbml0b3JpbmdDb25maWcsIGRlZmF1bHRTZWN1cml0eUNvbmZpZyB9IGZyb20gJy4vY29uZmlnJztcblxuLy8gU2VydmVyLW9ubHkgbW9kdWxlcyB0aGF0IHdpbGwgYmUgaW1wb3J0ZWQgY29uZGl0aW9uYWxseVxubGV0IHJhdGVMaW1pdCA9IG51bGw7XG5sZXQgdHJhY2tFeGNlcHRpb25GbiA9IG51bGw7XG5cbi8vIE9ubHkgaW1wb3J0IHNlcnZlci1zaWRlIG1vZHVsZXMgd2hlbiBydW5uaW5nIG9uIHRoZSBzZXJ2ZXJcbmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICB0cnkge1xuICAgIHJhdGVMaW1pdCA9IHJlcXVpcmUoJ2V4cHJlc3MtcmF0ZS1saW1pdCcpO1xuICAgIGNvbnN0IHsgdHJhY2tFeGNlcHRpb24gfSA9IHJlcXVpcmUoJy4vbW9uaXRvcmluZ1NlcnZpY2UnKTtcbiAgICB0cmFja0V4Y2VwdGlvbkZuID0gdHJhY2tFeGNlcHRpb247XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW1wb3J0aW5nIHNlcnZlci1zaWRlIG1vZHVsZXM6JywgZXJyb3IpO1xuICB9XG59XG5cbi8vIFJhdGUgbGltaXRpbmcgbWlkZGxld2FyZSAtIHdpbGwgb25seSB3b3JrIG9uIHNlcnZlciBzaWRlXG5leHBvcnQgY29uc3QgcmF0ZUxpbWl0ZXIgPSB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyAmJiByYXRlTGltaXQgPyBcbiAgcmF0ZUxpbWl0KHtcbiAgICB3aW5kb3dNczogNjAgKiAxMDAwLCAvLyAxIG1pbnV0ZVxuICAgIG1heDogZGVmYXVsdFNlY3VyaXR5Q29uZmlnLm1heFJlcXVlc3RzUGVyTWludXRlXG4gIH0pIDogXG4gIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmIChuZXh0KSBuZXh0KCk7XG4gIH07XG5cbi8vIElQIHJlc3RyaWN0aW9uIG1pZGRsZXdhcmVcbmV4cG9ydCBmdW5jdGlvbiBpcFJlc3RyaWN0aW9uKGNvbnRleHQ6IGFueSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFsbG93ZWRJUHMgPSBwcm9jZXNzLmVudi5BTExPV0VEX0lQUz8uc3BsaXQoJywnKSB8fCBbXTtcbiAgICBjb25zdCBjbGllbnRJUCA9IGNvbnRleHQucmVxPy5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXSB8fCBcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yZXE/LmNvbm5lY3Rpb24ucmVtb3RlQWRkcmVzcztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgaWYgKGFsbG93ZWRJUHMubGVuZ3RoID09PSAwKSByZXR1cm4gdHJ1ZTsgLy8gTm8gSVAgcmVzdHJpY3Rpb25zXG4gICAgXG4gICAgY29uc3QgaXNBbGxvd2VkID0gYWxsb3dlZElQcy5zb21lKGlwID0+IHtcbiAgICAgICAgaWYgKGlwLmluY2x1ZGVzKCcqJykpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm4gPSBpcC5yZXBsYWNlKC9cXC4vZywgJ1xcXFwuJykucmVwbGFjZSgvXFwqL2csICcuKicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4ke3BhdHRlcm59JGApLnRlc3QoY2xpZW50SVAgfHwgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpcCA9PT0gY2xpZW50SVA7XG4gICAgfSk7XG5cbiAgICBpZiAoIWlzQWxsb3dlZCAmJiB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyAmJiB0cmFja0V4Y2VwdGlvbkZuKSB7XG4gICAgICAgIHRyYWNrRXhjZXB0aW9uRm4obmV3IEVycm9yKCdJUCByZXN0cmljdGlvbiBmYWlsZWQnKSwge1xuICAgICAgICAgICAgY2xpZW50SVA6IGNsaWVudElQIHx8ICd1bmtub3duJyxcbiAgICAgICAgICAgIHNvdXJjZTogY29udGV4dC5leGVjdXRpb25Db250ZXh0LmZ1bmN0aW9uTmFtZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gaXNBbGxvd2VkO1xufVxuXG4vLyBSZXF1ZXN0IHZhbGlkYXRpb24gbWlkZGxld2FyZVxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUmVxdWVzdChjb250ZXh0OiBhbnkpOiBib29sZWFuIHtcbiAgICBjb25zdCBhdXRoSGVhZGVyID0gY29udGV4dC5yZXE/LmhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXTtcbiAgICBpZiAoIWF1dGhIZWFkZXIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnICYmIHRyYWNrRXhjZXB0aW9uRm4pIHtcbiAgICAgICAgICAgIHRyYWNrRXhjZXB0aW9uRm4obmV3IEVycm9yKCdNaXNzaW5nIGF1dGhvcml6YXRpb24gaGVhZGVyJyksIHtcbiAgICAgICAgICAgICAgICBzb3VyY2U6IGNvbnRleHQuZXhlY3V0aW9uQ29udGV4dC5mdW5jdGlvbk5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBKV1QgdG9rZW5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcbiAgICAgICAgLy8gVG9rZW4gdmFsaWRhdGlvbiBsb2dpYyB3b3VsZCBnbyBoZXJlXG4gICAgICAgIC8vIEZvciBub3csIGp1c3QgY2hlY2sgaWYgaXQgZXhpc3RzXG4gICAgICAgIHJldHVybiAhIXRva2VuO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyAmJiB0cmFja0V4Y2VwdGlvbkZuKSB7XG4gICAgICAgICAgICB0cmFja0V4Y2VwdGlvbkZuKGVycm9yIGFzIEVycm9yLCB7XG4gICAgICAgICAgICAgICAgc291cmNlOiBjb250ZXh0LmV4ZWN1dGlvbkNvbnRleHQuZnVuY3Rpb25OYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG4vLyBQZXJmb3JtYW5jZSBtb25pdG9yaW5nIG1pZGRsZXdhcmVcbmV4cG9ydCBmdW5jdGlvbiBtb25pdG9yUGVyZm9ybWFuY2UoY29udGV4dDogYW55LCBvcGVyYXRpb25OYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGVuZDogKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICAgICAgaWYgKGNvbnRleHQubG9nICYmIHR5cGVvZiBjb250ZXh0LmxvZy5pbmZvID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5sb2cuaW5mbygnT3BlcmF0aW9uIGNvbXBsZXRlZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogb3BlcmF0aW9uTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICFjb250ZXh0LnJlcz8uc3RhdHVzIHx8IGNvbnRleHQucmVzLnN0YXR1cyA8IDQwMCxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lOiBjb250ZXh0LmV4ZWN1dGlvbkNvbnRleHQ/LmZ1bmN0aW9uTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaW52b2NhdGlvbklkOiBjb250ZXh0LmV4ZWN1dGlvbkNvbnRleHQ/Lmludm9jYXRpb25JZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplSW5wdXQoaW5wdXQ6IGFueSk6IGFueSB7XG4gICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgLy8gUmVtb3ZlIHBvdGVudGlhbCBYU1MgY29udGVudFxuICAgICAgICByZXR1cm4gaW5wdXRcbiAgICAgICAgICAgIC5yZXBsYWNlKC9bPD5dL2csICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL2phdmFzY3JpcHQ6L2dpLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9vblxcdys9L2dpLCAnJyk7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSkge1xuICAgICAgICByZXR1cm4gaW5wdXQubWFwKGl0ZW0gPT4gc2FuaXRpemVJbnB1dChpdGVtKSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnICYmIGlucHV0ICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHNhbml0aXplZDogYW55ID0ge307XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGlucHV0KSkge1xuICAgICAgICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUlucHV0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2FuaXRpemVkO1xuICAgIH1cbiAgICByZXR1cm4gaW5wdXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRlbnRUeXBlKGNvbnRleHQ6IGFueSwgZXhwZWN0ZWRUeXBlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IGNvbnRleHQucmVxPy5oZWFkZXJzWydjb250ZW50LXR5cGUnXSB8fCAnJztcbiAgICByZXR1cm4gY29udGVudFR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhleHBlY3RlZFR5cGUudG9Mb3dlckNhc2UoKSk7XG59XG5cbi8vIEF1dGggbWlkZGxld2FyZSBmb3IgTmV4dC5qcyBBUEkgcm91dGVzXG5leHBvcnQgZnVuY3Rpb24gd2l0aEFwaUF1dGgoaGFuZGxlcikge1xuICAgIHJldHVybiBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgICAgLy8gQXV0aGVudGljYXRpb24gbG9naWMgd291bGQgZ28gaGVyZVxuICAgICAgICAvLyBGb3Igbm93LCBqdXN0IHBhc3MgdGhyb3VnaFxuICAgICAgICByZXR1cm4gaGFuZGxlcihyZXEsIHJlcyk7XG4gICAgfTtcbn0iXSwibmFtZXMiOlsiZGVmYXVsdFNlY3VyaXR5Q29uZmlnIiwicmF0ZUxpbWl0IiwidHJhY2tFeGNlcHRpb25GbiIsInJlcXVpcmUiLCJ0cmFja0V4Y2VwdGlvbiIsImVycm9yIiwiY29uc29sZSIsInJhdGVMaW1pdGVyIiwid2luZG93TXMiLCJtYXgiLCJtYXhSZXF1ZXN0c1Blck1pbnV0ZSIsInJlcSIsInJlcyIsIm5leHQiLCJpcFJlc3RyaWN0aW9uIiwiY29udGV4dCIsImFsbG93ZWRJUHMiLCJwcm9jZXNzIiwiZW52IiwiQUxMT1dFRF9JUFMiLCJzcGxpdCIsImNsaWVudElQIiwiaGVhZGVycyIsImNvbm5lY3Rpb24iLCJyZW1vdGVBZGRyZXNzIiwibGVuZ3RoIiwiaXNBbGxvd2VkIiwic29tZSIsImlwIiwiaW5jbHVkZXMiLCJwYXR0ZXJuIiwicmVwbGFjZSIsIlJlZ0V4cCIsInRlc3QiLCJFcnJvciIsInNvdXJjZSIsImV4ZWN1dGlvbkNvbnRleHQiLCJmdW5jdGlvbk5hbWUiLCJ2YWxpZGF0ZVJlcXVlc3QiLCJhdXRoSGVhZGVyIiwidG9rZW4iLCJtb25pdG9yUGVyZm9ybWFuY2UiLCJvcGVyYXRpb25OYW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImVuZCIsImR1cmF0aW9uIiwibG9nIiwiaW5mbyIsIm5hbWUiLCJzdWNjZXNzIiwic3RhdHVzIiwiaW52b2NhdGlvbklkIiwic2FuaXRpemVJbnB1dCIsImlucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiaXRlbSIsInNhbml0aXplZCIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsInZhbGlkYXRlQ29udGVudFR5cGUiLCJleHBlY3RlZFR5cGUiLCJjb250ZW50VHlwZSIsInRvTG93ZXJDYXNlIiwid2l0aEFwaUF1dGgiLCJoYW5kbGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/middleware.ts\n");

/***/ }),

/***/ "(api)/./lib/monitoringService.ts":
/*!**********************************!*\
  !*** ./lib/monitoringService.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   queryLogs: () => (/* binding */ queryLogs),\n/* harmony export */   startOperation: () => (/* binding */ startOperation),\n/* harmony export */   stopOperation: () => (/* binding */ stopOperation),\n/* harmony export */   trackDependency: () => (/* binding */ trackDependency),\n/* harmony export */   trackEvent: () => (/* binding */ trackEvent),\n/* harmony export */   trackException: () => (/* binding */ trackException),\n/* harmony export */   trackMetric: () => (/* binding */ trackMetric),\n/* harmony export */   trackRequest: () => (/* binding */ trackRequest)\n/* harmony export */ });\n// Use dynamic imports for server-only modules\n// These modules will only be imported on the server\n// Import placeholders for server-side modules\nlet appInsightsModule = null;\nlet DefaultAzureCredentialClass = null;\nlet LogAnalyticsClientClass = null;\n// Only import server-side modules when running on the server\nif (true) {\n    try {\n        appInsightsModule = __webpack_require__(/*! applicationinsights */ \"applicationinsights\");\n        const { DefaultAzureCredential } = __webpack_require__(/*! @azure/identity */ \"@azure/identity?e5d3\");\n        const { LogAnalyticsClient } = __webpack_require__(/*! @azure/monitor-query */ \"@azure/monitor-query\");\n        DefaultAzureCredentialClass = DefaultAzureCredential;\n        LogAnalyticsClientClass = LogAnalyticsClient;\n    } catch (error) {\n        console.error(\"Error importing server-side modules:\", error);\n    }\n}\nclass MonitoringService {\n    constructor(){\n        this.initialized = false;\n        if (true) {\n            this.initializeAppInsights();\n            this.initializeLogAnalytics();\n        }\n    }\n    static getInstance() {\n        if (!MonitoringService.instance) {\n            MonitoringService.instance = new MonitoringService();\n        }\n        return MonitoringService.instance;\n    }\n    initializeAppInsights() {\n        if (!this.initialized && process.env.APPLICATIONINSIGHTS_CONNECTION_STRING && appInsightsModule) {\n            appInsightsModule.setup(process.env.APPLICATIONINSIGHTS_CONNECTION_STRING).setAutoDependencyCorrelation(true).setAutoCollectRequests(true).setAutoCollectPerformance(true).setAutoCollectExceptions(true).setAutoCollectDependencies(true).setAutoCollectConsole(true).setUseDiskRetryCaching(true).setSendLiveMetrics(true).setDistributedTracingMode(appInsightsModule.DistributedTracingModes.AI_AND_W3C);\n            appInsightsModule.defaultClient.context.tags[appInsightsModule.defaultClient.context.keys.cloudRole] = \"HigueraFunction\";\n            appInsightsModule.start();\n            this.client = appInsightsModule.defaultClient;\n            this.initialized = true;\n        }\n    }\n    initializeLogAnalytics() {\n        if (DefaultAzureCredentialClass && LogAnalyticsClientClass) {\n            try {\n                const credential = new DefaultAzureCredentialClass();\n                this.logAnalyticsClient = new LogAnalyticsClientClass(credential);\n            } catch (error) {\n                console.error(\"Error initializing Log Analytics client:\", error);\n            }\n        }\n    }\n    trackException(error, properties) {\n        if ( false || !this.initialized) {\n            return; // Skip on client-side\n        }\n        try {\n            const enhancedProperties = {\n                ...properties,\n                errorName: error.name,\n                stackTrace: error.stack,\n                timestamp: new Date().toISOString()\n            };\n            this.client.trackException({\n                exception: error,\n                properties: enhancedProperties\n            });\n        } catch (error) {\n            console.error(\"Error tracking exception:\", error);\n        }\n    }\n    trackEvent(name, properties) {\n        if ( false || !this.initialized) {\n            return; // Skip on client-side\n        }\n        try {\n            const enhancedProperties = {\n                ...properties,\n                timestamp: new Date().toISOString(),\n                environment: process.env.AZURE_ENVIRONMENT || \"development\"\n            };\n            this.client.trackEvent({\n                name,\n                properties: enhancedProperties\n            });\n        } catch (error) {\n            console.error(\"Error tracking event:\", error);\n        }\n    }\n    trackMetric(name, value, properties) {\n        if ( false || !this.initialized) {\n            return; // Skip on client-side\n        }\n        try {\n            const enhancedProperties = {\n                ...properties,\n                timestamp: new Date().toISOString(),\n                environment: process.env.AZURE_ENVIRONMENT || \"development\"\n            };\n            this.client.trackMetric({\n                name,\n                value,\n                properties: enhancedProperties\n            });\n        } catch (error) {\n            console.error(\"Error tracking metric:\", error);\n        }\n    }\n    trackRequest(name, url, duration, success, properties) {\n        if ( false || !this.initialized) {\n            return; // Skip on client-side\n        }\n        try {\n            const enhancedProperties = {\n                ...properties,\n                timestamp: new Date().toISOString(),\n                environment: process.env.AZURE_ENVIRONMENT || \"development\"\n            };\n            this.client.trackRequest({\n                name,\n                url,\n                duration,\n                success,\n                properties: enhancedProperties\n            });\n        } catch (error) {\n            console.error(\"Error tracking request:\", error);\n        }\n    }\n    trackDependency(name, data, duration, success, properties) {\n        if ( false || !this.initialized) {\n            return; // Skip on client-side\n        }\n        try {\n            const enhancedProperties = {\n                ...properties,\n                timestamp: new Date().toISOString(),\n                environment: process.env.AZURE_ENVIRONMENT || \"development\"\n            };\n            this.client.trackDependency({\n                name,\n                data,\n                duration,\n                success,\n                properties: enhancedProperties,\n                dependencyTypeName: \"HTTP\"\n            });\n        } catch (error) {\n            console.error(\"Error tracking dependency:\", error);\n        }\n    }\n    async queryLogs(query, timeRange) {\n        if ( false || !this.logAnalyticsClient) {\n            return null; // Skip on client-side\n        }\n        try {\n            const workspaceId = process.env.LOG_ANALYTICS_WORKSPACE_ID;\n            if (!workspaceId) {\n                throw new Error(\"LOG_ANALYTICS_WORKSPACE_ID not configured\");\n            }\n            const result = await this.logAnalyticsClient.queryWorkspace(workspaceId, query, {\n                timeRange\n            });\n            return result;\n        } catch (error) {\n            if (this.initialized) {\n                this.trackException(error, {\n                    operation: \"queryLogs\"\n                });\n            }\n            throw error;\n        }\n    }\n    startOperation(name) {\n        if ( false || !this.initialized) {\n            return null; // Skip on client-side\n        }\n        try {\n            return this.client.startOperation({\n                name\n            });\n        } catch (error) {\n            console.error(\"Error starting operation:\", error);\n            return null;\n        }\n    }\n    stopOperation(operation) {\n        if ( false || !this.initialized || !operation) {\n            return; // Skip on client-side\n        }\n        try {\n            this.client.stopOperation(operation);\n        } catch (error) {\n            console.error(\"Error stopping operation:\", error);\n        }\n    }\n}\n// Export singleton instance methods\nconst monitoringService = MonitoringService.getInstance();\nconst trackException = (error, properties)=>monitoringService.trackException(error, properties);\nconst trackEvent = (name, properties)=>monitoringService.trackEvent(name, properties);\nconst trackMetric = (name, value, properties)=>monitoringService.trackMetric(name, value, properties);\nconst trackRequest = (name, url, duration, success, properties)=>monitoringService.trackRequest(name, url, duration, success, properties);\nconst trackDependency = (name, data, duration, success, properties)=>monitoringService.trackDependency(name, data, duration, success, properties);\nconst queryLogs = (query, timeRange)=>monitoringService.queryLogs(query, timeRange);\nconst startOperation = (name)=>monitoringService.startOperation(name);\nconst stopOperation = (operation)=>monitoringService.stopOperation(operation);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQ1AsTUFBTUgsWUFBWTtBQUU1QyxNQUFNYSxjQUFjLENBQUNWLE1BQWNXLE9BQWVkLGFBQ3JEaUMsa0JBQWtCcEIsV0FBVyxDQUFDVixNQUFNVyxPQUFPZCxZQUFZO0FBRXBELE1BQU1lLGVBQWUsQ0FBQ1osTUFBY2EsS0FBYUMsVUFBa0JDLFNBQWtCbEIsYUFDeEZpQyxrQkFBa0JsQixZQUFZLENBQUNaLE1BQU1hLEtBQUtDLFVBQVVDLFNBQVNsQixZQUFZO0FBRXRFLE1BQU1tQixrQkFBa0IsQ0FBQ2hCLE1BQWNpQixNQUFjSCxVQUFrQkMsU0FBa0JsQixhQUM1RmlDLGtCQUFrQmQsZUFBZSxDQUFDaEIsTUFBTWlCLE1BQU1ILFVBQVVDLFNBQVNsQixZQUFZO0FBRTFFLE1BQU1zQixZQUFZLENBQUNDLE9BQWVDLFlBQ3JDUyxrQkFBa0JYLFNBQVMsQ0FBQ0MsT0FBT0MsV0FBVztBQUUzQyxNQUFNTyxpQkFBaUIsQ0FBQzVCLE9BQzNCOEIsa0JBQWtCRixjQUFjLENBQUM1QixNQUFNO0FBRXBDLE1BQU02QixnQkFBZ0IsQ0FBQ0YsWUFDMUJHLGtCQUFrQkQsYUFBYSxDQUFDRixXQUFXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGlndWVyYWF6dXJlZnVuY3Rpb24vLi9saWIvbW9uaXRvcmluZ1NlcnZpY2UudHM/ODhkZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBVc2UgZHluYW1pYyBpbXBvcnRzIGZvciBzZXJ2ZXItb25seSBtb2R1bGVzXG4vLyBUaGVzZSBtb2R1bGVzIHdpbGwgb25seSBiZSBpbXBvcnRlZCBvbiB0aGUgc2VydmVyXG5cbi8vIEltcG9ydCBwbGFjZWhvbGRlcnMgZm9yIHNlcnZlci1zaWRlIG1vZHVsZXNcbmxldCBhcHBJbnNpZ2h0c01vZHVsZTogYW55ID0gbnVsbDtcbmxldCBEZWZhdWx0QXp1cmVDcmVkZW50aWFsQ2xhc3M6IGFueSA9IG51bGw7XG5sZXQgTG9nQW5hbHl0aWNzQ2xpZW50Q2xhc3M6IGFueSA9IG51bGw7XG5cbi8vIE9ubHkgaW1wb3J0IHNlcnZlci1zaWRlIG1vZHVsZXMgd2hlbiBydW5uaW5nIG9uIHRoZSBzZXJ2ZXJcbmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICB0cnkge1xuICAgIGFwcEluc2lnaHRzTW9kdWxlID0gcmVxdWlyZSgnYXBwbGljYXRpb25pbnNpZ2h0cycpO1xuICAgIGNvbnN0IHsgRGVmYXVsdEF6dXJlQ3JlZGVudGlhbCB9ID0gcmVxdWlyZSgnQGF6dXJlL2lkZW50aXR5Jyk7XG4gICAgY29uc3QgeyBMb2dBbmFseXRpY3NDbGllbnQgfSA9IHJlcXVpcmUoJ0BhenVyZS9tb25pdG9yLXF1ZXJ5Jyk7XG4gICAgXG4gICAgRGVmYXVsdEF6dXJlQ3JlZGVudGlhbENsYXNzID0gRGVmYXVsdEF6dXJlQ3JlZGVudGlhbDtcbiAgICBMb2dBbmFseXRpY3NDbGllbnRDbGFzcyA9IExvZ0FuYWx5dGljc0NsaWVudDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbXBvcnRpbmcgc2VydmVyLXNpZGUgbW9kdWxlczonLCBlcnJvcik7XG4gIH1cbn1cblxuY2xhc3MgTW9uaXRvcmluZ1NlcnZpY2Uge1xuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBNb25pdG9yaW5nU2VydmljZTtcbiAgICBwcml2YXRlIGNsaWVudDogYW55O1xuICAgIHByaXZhdGUgbG9nQW5hbHl0aWNzQ2xpZW50OiBhbnk7XG4gICAgcHJpdmF0ZSBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVBcHBJbnNpZ2h0cygpO1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplTG9nQW5hbHl0aWNzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IE1vbml0b3JpbmdTZXJ2aWNlIHtcbiAgICAgICAgaWYgKCFNb25pdG9yaW5nU2VydmljZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgTW9uaXRvcmluZ1NlcnZpY2UuaW5zdGFuY2UgPSBuZXcgTW9uaXRvcmluZ1NlcnZpY2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTW9uaXRvcmluZ1NlcnZpY2UuaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0aWFsaXplQXBwSW5zaWdodHMoKSB7XG4gICAgICAgIGlmICghdGhpcy5pbml0aWFsaXplZCAmJiBwcm9jZXNzLmVudi5BUFBMSUNBVElPTklOU0lHSFRTX0NPTk5FQ1RJT05fU1RSSU5HICYmIGFwcEluc2lnaHRzTW9kdWxlKSB7XG4gICAgICAgICAgICBhcHBJbnNpZ2h0c01vZHVsZS5zZXR1cChwcm9jZXNzLmVudi5BUFBMSUNBVElPTklOU0lHSFRTX0NPTk5FQ1RJT05fU1RSSU5HKVxuICAgICAgICAgICAgICAgIC5zZXRBdXRvRGVwZW5kZW5jeUNvcnJlbGF0aW9uKHRydWUpXG4gICAgICAgICAgICAgICAgLnNldEF1dG9Db2xsZWN0UmVxdWVzdHModHJ1ZSlcbiAgICAgICAgICAgICAgICAuc2V0QXV0b0NvbGxlY3RQZXJmb3JtYW5jZSh0cnVlKVxuICAgICAgICAgICAgICAgIC5zZXRBdXRvQ29sbGVjdEV4Y2VwdGlvbnModHJ1ZSlcbiAgICAgICAgICAgICAgICAuc2V0QXV0b0NvbGxlY3REZXBlbmRlbmNpZXModHJ1ZSlcbiAgICAgICAgICAgICAgICAuc2V0QXV0b0NvbGxlY3RDb25zb2xlKHRydWUpXG4gICAgICAgICAgICAgICAgLnNldFVzZURpc2tSZXRyeUNhY2hpbmcodHJ1ZSlcbiAgICAgICAgICAgICAgICAuc2V0U2VuZExpdmVNZXRyaWNzKHRydWUpXG4gICAgICAgICAgICAgICAgLnNldERpc3RyaWJ1dGVkVHJhY2luZ01vZGUoYXBwSW5zaWdodHNNb2R1bGUuRGlzdHJpYnV0ZWRUcmFjaW5nTW9kZXMuQUlfQU5EX1czQyk7XG5cbiAgICAgICAgICAgIGFwcEluc2lnaHRzTW9kdWxlLmRlZmF1bHRDbGllbnQuY29udGV4dC50YWdzW2FwcEluc2lnaHRzTW9kdWxlLmRlZmF1bHRDbGllbnQuY29udGV4dC5rZXlzLmNsb3VkUm9sZV0gPSBcIkhpZ3VlcmFGdW5jdGlvblwiO1xuICAgICAgICAgICAgYXBwSW5zaWdodHNNb2R1bGUuc3RhcnQoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5jbGllbnQgPSBhcHBJbnNpZ2h0c01vZHVsZS5kZWZhdWx0Q2xpZW50O1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRpYWxpemVMb2dBbmFseXRpY3MoKSB7XG4gICAgICAgIGlmIChEZWZhdWx0QXp1cmVDcmVkZW50aWFsQ2xhc3MgJiYgTG9nQW5hbHl0aWNzQ2xpZW50Q2xhc3MpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IG5ldyBEZWZhdWx0QXp1cmVDcmVkZW50aWFsQ2xhc3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ0FuYWx5dGljc0NsaWVudCA9IG5ldyBMb2dBbmFseXRpY3NDbGllbnRDbGFzcyhjcmVkZW50aWFsKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW5pdGlhbGl6aW5nIExvZyBBbmFseXRpY3MgY2xpZW50OicsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyB0cmFja0V4Y2VwdGlvbihlcnJvcjogRXJyb3IsIHByb3BlcnRpZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyB8fCAhdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuOyAvLyBTa2lwIG9uIGNsaWVudC1zaWRlXG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZW5oYW5jZWRQcm9wZXJ0aWVzID0ge1xuICAgICAgICAgICAgICAgIC4uLnByb3BlcnRpZXMsXG4gICAgICAgICAgICAgICAgZXJyb3JOYW1lOiBlcnJvci5uYW1lLFxuICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IGVycm9yLnN0YWNrLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmNsaWVudC50cmFja0V4Y2VwdGlvbih7XG4gICAgICAgICAgICAgICAgZXhjZXB0aW9uOiBlcnJvcixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBlbmhhbmNlZFByb3BlcnRpZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdHJhY2tpbmcgZXhjZXB0aW9uOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyB0cmFja0V2ZW50KG5hbWU6IHN0cmluZywgcHJvcGVydGllcz86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnIHx8ICF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICByZXR1cm47IC8vIFNraXAgb24gY2xpZW50LXNpZGVcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlbmhhbmNlZFByb3BlcnRpZXMgPSB7XG4gICAgICAgICAgICAgICAgLi4ucHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuQVpVUkVfRU5WSVJPTk1FTlQgfHwgJ2RldmVsb3BtZW50J1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5jbGllbnQudHJhY2tFdmVudCh7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBlbmhhbmNlZFByb3BlcnRpZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdHJhY2tpbmcgZXZlbnQ6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHRyYWNrTWV0cmljKG5hbWU6IHN0cmluZywgdmFsdWU6IG51bWJlciwgcHJvcGVydGllcz86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnIHx8ICF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICByZXR1cm47IC8vIFNraXAgb24gY2xpZW50LXNpZGVcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlbmhhbmNlZFByb3BlcnRpZXMgPSB7XG4gICAgICAgICAgICAgICAgLi4ucHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuQVpVUkVfRU5WSVJPTk1FTlQgfHwgJ2RldmVsb3BtZW50J1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5jbGllbnQudHJhY2tNZXRyaWMoe1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczogZW5oYW5jZWRQcm9wZXJ0aWVzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHRyYWNraW5nIG1ldHJpYzonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgdHJhY2tSZXF1ZXN0KG5hbWU6IHN0cmluZywgdXJsOiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIsIHN1Y2Nlc3M6IGJvb2xlYW4sIHByb3BlcnRpZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyB8fCAhdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuOyAvLyBTa2lwIG9uIGNsaWVudC1zaWRlXG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZW5oYW5jZWRQcm9wZXJ0aWVzID0ge1xuICAgICAgICAgICAgICAgIC4uLnByb3BlcnRpZXMsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgZW52aXJvbm1lbnQ6IHByb2Nlc3MuZW52LkFaVVJFX0VOVklST05NRU5UIHx8ICdkZXZlbG9wbWVudCdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuY2xpZW50LnRyYWNrUmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBlbmhhbmNlZFByb3BlcnRpZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdHJhY2tpbmcgcmVxdWVzdDonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgdHJhY2tEZXBlbmRlbmN5KG5hbWU6IHN0cmluZywgZGF0YTogc3RyaW5nLCBkdXJhdGlvbjogbnVtYmVyLCBzdWNjZXNzOiBib29sZWFuLCBwcm9wZXJ0aWVzPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSkge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgfHwgIXRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gU2tpcCBvbiBjbGllbnQtc2lkZVxuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGVuaGFuY2VkUHJvcGVydGllcyA9IHtcbiAgICAgICAgICAgICAgICAuLi5wcm9wZXJ0aWVzLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGVudmlyb25tZW50OiBwcm9jZXNzLmVudi5BWlVSRV9FTlZJUk9OTUVOVCB8fCAnZGV2ZWxvcG1lbnQnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmNsaWVudC50cmFja0RlcGVuZGVuY3koe1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgICAgICBzdWNjZXNzLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IGVuaGFuY2VkUHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICBkZXBlbmRlbmN5VHlwZU5hbWU6IFwiSFRUUFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHRyYWNraW5nIGRlcGVuZGVuY3k6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHF1ZXJ5TG9ncyhxdWVyeTogc3RyaW5nLCB0aW1lUmFuZ2U6IHsgc3RhcnQ6IERhdGU7IGVuZDogRGF0ZSB9KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyB8fCAhdGhpcy5sb2dBbmFseXRpY3NDbGllbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBTa2lwIG9uIGNsaWVudC1zaWRlXG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgd29ya3NwYWNlSWQgPSBwcm9jZXNzLmVudi5MT0dfQU5BTFlUSUNTX1dPUktTUEFDRV9JRDtcbiAgICAgICAgICAgIGlmICghd29ya3NwYWNlSWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xPR19BTkFMWVRJQ1NfV09SS1NQQUNFX0lEIG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubG9nQW5hbHl0aWNzQ2xpZW50LnF1ZXJ5V29ya3NwYWNlKFxuICAgICAgICAgICAgICAgIHdvcmtzcGFjZUlkLFxuICAgICAgICAgICAgICAgIHF1ZXJ5LFxuICAgICAgICAgICAgICAgIHsgdGltZVJhbmdlIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhY2tFeGNlcHRpb24oZXJyb3IgYXMgRXJyb3IsIHsgb3BlcmF0aW9uOiAncXVlcnlMb2dzJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXJ0T3BlcmF0aW9uKG5hbWU6IHN0cmluZyk6IGFueSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyB8fCAhdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIFNraXAgb24gY2xpZW50LXNpZGVcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jbGllbnQuc3RhcnRPcGVyYXRpb24oeyBuYW1lIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc3RhcnRpbmcgb3BlcmF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0b3BPcGVyYXRpb24ob3BlcmF0aW9uOiBhbnkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnIHx8ICF0aGlzLmluaXRpYWxpemVkIHx8ICFvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gU2tpcCBvbiBjbGllbnQtc2lkZVxuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY2xpZW50LnN0b3BPcGVyYXRpb24ob3BlcmF0aW9uKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0b3BwaW5nIG9wZXJhdGlvbjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2UgbWV0aG9kc1xuY29uc3QgbW9uaXRvcmluZ1NlcnZpY2UgPSBNb25pdG9yaW5nU2VydmljZS5nZXRJbnN0YW5jZSgpO1xuXG5leHBvcnQgY29uc3QgdHJhY2tFeGNlcHRpb24gPSAoZXJyb3I6IEVycm9yLCBwcm9wZXJ0aWVzPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSkgPT4gXG4gICAgbW9uaXRvcmluZ1NlcnZpY2UudHJhY2tFeGNlcHRpb24oZXJyb3IsIHByb3BlcnRpZXMpO1xuXG5leHBvcnQgY29uc3QgdHJhY2tFdmVudCA9IChuYW1lOiBzdHJpbmcsIHByb3BlcnRpZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSA9PiBcbiAgICBtb25pdG9yaW5nU2VydmljZS50cmFja0V2ZW50KG5hbWUsIHByb3BlcnRpZXMpO1xuXG5leHBvcnQgY29uc3QgdHJhY2tNZXRyaWMgPSAobmFtZTogc3RyaW5nLCB2YWx1ZTogbnVtYmVyLCBwcm9wZXJ0aWVzPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSkgPT4gXG4gICAgbW9uaXRvcmluZ1NlcnZpY2UudHJhY2tNZXRyaWMobmFtZSwgdmFsdWUsIHByb3BlcnRpZXMpO1xuXG5leHBvcnQgY29uc3QgdHJhY2tSZXF1ZXN0ID0gKG5hbWU6IHN0cmluZywgdXJsOiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIsIHN1Y2Nlc3M6IGJvb2xlYW4sIHByb3BlcnRpZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSA9PiBcbiAgICBtb25pdG9yaW5nU2VydmljZS50cmFja1JlcXVlc3QobmFtZSwgdXJsLCBkdXJhdGlvbiwgc3VjY2VzcywgcHJvcGVydGllcyk7XG5cbmV4cG9ydCBjb25zdCB0cmFja0RlcGVuZGVuY3kgPSAobmFtZTogc3RyaW5nLCBkYXRhOiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIsIHN1Y2Nlc3M6IGJvb2xlYW4sIHByb3BlcnRpZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSA9PiBcbiAgICBtb25pdG9yaW5nU2VydmljZS50cmFja0RlcGVuZGVuY3kobmFtZSwgZGF0YSwgZHVyYXRpb24sIHN1Y2Nlc3MsIHByb3BlcnRpZXMpO1xuXG5leHBvcnQgY29uc3QgcXVlcnlMb2dzID0gKHF1ZXJ5OiBzdHJpbmcsIHRpbWVSYW5nZTogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH0pID0+IFxuICAgIG1vbml0b3JpbmdTZXJ2aWNlLnF1ZXJ5TG9ncyhxdWVyeSwgdGltZVJhbmdlKTtcblxuZXhwb3J0IGNvbnN0IHN0YXJ0T3BlcmF0aW9uID0gKG5hbWU6IHN0cmluZykgPT4gXG4gICAgbW9uaXRvcmluZ1NlcnZpY2Uuc3RhcnRPcGVyYXRpb24obmFtZSk7XG5cbmV4cG9ydCBjb25zdCBzdG9wT3BlcmF0aW9uID0gKG9wZXJhdGlvbjogYW55KSA9PiBcbiAgICBtb25pdG9yaW5nU2VydmljZS5zdG9wT3BlcmF0aW9uKG9wZXJhdGlvbik7Il0sIm5hbWVzIjpbImFwcEluc2lnaHRzTW9kdWxlIiwiRGVmYXVsdEF6dXJlQ3JlZGVudGlhbENsYXNzIiwiTG9nQW5hbHl0aWNzQ2xpZW50Q2xhc3MiLCJyZXF1aXJlIiwiRGVmYXVsdEF6dXJlQ3JlZGVudGlhbCIsIkxvZ0FuYWx5dGljc0NsaWVudCIsImVycm9yIiwiY29uc29sZSIsIk1vbml0b3JpbmdTZXJ2aWNlIiwiaW5pdGlhbGl6ZWQiLCJpbml0aWFsaXplQXBwSW5zaWdodHMiLCJpbml0aWFsaXplTG9nQW5hbHl0aWNzIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsInByb2Nlc3MiLCJlbnYiLCJBUFBMSUNBVElPTklOU0lHSFRTX0NPTk5FQ1RJT05fU1RSSU5HIiwic2V0dXAiLCJzZXRBdXRvRGVwZW5kZW5jeUNvcnJlbGF0aW9uIiwic2V0QXV0b0NvbGxlY3RSZXF1ZXN0cyIsInNldEF1dG9Db2xsZWN0UGVyZm9ybWFuY2UiLCJzZXRBdXRvQ29sbGVjdEV4Y2VwdGlvbnMiLCJzZXRBdXRvQ29sbGVjdERlcGVuZGVuY2llcyIsInNldEF1dG9Db2xsZWN0Q29uc29sZSIsInNldFVzZURpc2tSZXRyeUNhY2hpbmciLCJzZXRTZW5kTGl2ZU1ldHJpY3MiLCJzZXREaXN0cmlidXRlZFRyYWNpbmdNb2RlIiwiRGlzdHJpYnV0ZWRUcmFjaW5nTW9kZXMiLCJBSV9BTkRfVzNDIiwiZGVmYXVsdENsaWVudCIsImNvbnRleHQiLCJ0YWdzIiwia2V5cyIsImNsb3VkUm9sZSIsInN0YXJ0IiwiY2xpZW50IiwiY3JlZGVudGlhbCIsImxvZ0FuYWx5dGljc0NsaWVudCIsInRyYWNrRXhjZXB0aW9uIiwicHJvcGVydGllcyIsImVuaGFuY2VkUHJvcGVydGllcyIsImVycm9yTmFtZSIsIm5hbWUiLCJzdGFja1RyYWNlIiwic3RhY2siLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJleGNlcHRpb24iLCJ0cmFja0V2ZW50IiwiZW52aXJvbm1lbnQiLCJBWlVSRV9FTlZJUk9OTUVOVCIsInRyYWNrTWV0cmljIiwidmFsdWUiLCJ0cmFja1JlcXVlc3QiLCJ1cmwiLCJkdXJhdGlvbiIsInN1Y2Nlc3MiLCJ0cmFja0RlcGVuZGVuY3kiLCJkYXRhIiwiZGVwZW5kZW5jeVR5cGVOYW1lIiwicXVlcnlMb2dzIiwicXVlcnkiLCJ0aW1lUmFuZ2UiLCJ3b3Jrc3BhY2VJZCIsIkxPR19BTkFMWVRJQ1NfV09SS1NQQUNFX0lEIiwiRXJyb3IiLCJyZXN1bHQiLCJxdWVyeVdvcmtzcGFjZSIsIm9wZXJhdGlvbiIsInN0YXJ0T3BlcmF0aW9uIiwic3RvcE9wZXJhdGlvbiIsIm1vbml0b3JpbmdTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/monitoringService.ts\n");

/***/ }),

/***/ "(api)/./pages/api/exportExcel.js":
/*!**********************************!*\
  !*** ./pages/api/exportExcel.js ***!
  \**********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_middleware__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/middleware */ \"(api)/./lib/middleware.ts\");\n/* harmony import */ var _lib_monitoringService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/monitoringService */ \"(api)/./lib/monitoringService.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_middleware__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_middleware__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n// Define server-only modules that will be imported conditionally\nlet fs = null;\nlet path = null;\nlet ExcelJS = null;\n// Only import server-side modules when running on the server\nif (true) {\n    try {\n        fs = __webpack_require__(/*! fs */ \"fs\");\n        path = __webpack_require__(/*! path */ \"path\");\n        ExcelJS = __webpack_require__(/*! exceljs */ \"exceljs\");\n    } catch (error) {\n        console.error(\"Error importing server-side modules:\", error);\n    }\n}\nasync function handler(req, res) {\n    // This is an API route, which only runs on the server side\n    // But we still need to ensure the imports worked correctly\n    if (!fs || !path || !ExcelJS) {\n        return res.status(500).json({\n            error: \"Server-side modules not available\"\n        });\n    }\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const startTime = performance.now();\n    try {\n        // Read the data.json file\n        const dataPath = path.join(process.cwd(), \"public\", \"data\", \"data.json\");\n        const dataRaw = fs.readFileSync(dataPath, \"utf8\");\n        const data = JSON.parse(dataRaw);\n        // Create a new Excel workbook\n        const workbook = new ExcelJS.Workbook();\n        workbook.creator = \"Higuera Project Dashboard\";\n        workbook.lastModifiedBy = \"API\";\n        workbook.created = new Date();\n        workbook.modified = new Date();\n        // Project Overview Sheet\n        const overviewSheet = workbook.addWorksheet(\"Project Overview\");\n        overviewSheet.columns = [\n            {\n                header: \"Parameter\",\n                key: \"parameter\",\n                width: 25\n            },\n            {\n                header: \"Value\",\n                key: \"value\",\n                width: 15\n            },\n            {\n                header: \"Notes\",\n                key: \"notes\",\n                width: 40\n            }\n        ];\n        // Add project overview data\n        overviewSheet.addRows([\n            {\n                parameter: \"Project Start\",\n                value: data.hoursTracking.startDate,\n                notes: \"\"\n            },\n            {\n                parameter: \"Planned End Date\",\n                value: data.hoursTracking.plannedEndDate,\n                notes: \"\"\n            },\n            {\n                parameter: \"Projected End Date\",\n                value: data.hoursTracking.projectedEndDate,\n                notes: \"Based on current burndown rate\"\n            },\n            {\n                parameter: \"Total Budget\",\n                value: data.kpis.totalBudget,\n                notes: \"USD\"\n            },\n            {\n                parameter: \"Spent\",\n                value: data.kpis.spent,\n                notes: \"USD\"\n            },\n            {\n                parameter: \"Remaining\",\n                value: data.kpis.remaining,\n                notes: \"USD\"\n            },\n            {\n                parameter: \"Overrun Risk\",\n                value: data.kpis.risk,\n                notes: \"\"\n            },\n            {\n                parameter: \"Total Hours Allocated\",\n                value: data.hoursTracking.totalHoursAllocated,\n                notes: \"\"\n            },\n            {\n                parameter: \"Total Hours Used\",\n                value: data.hoursTracking.totalHoursUsed,\n                notes: \"\"\n            },\n            {\n                parameter: \"Hours Remaining\",\n                value: data.hoursTracking.completionMetrics.hoursRemaining,\n                notes: \"\"\n            },\n            {\n                parameter: \"Percent Complete\",\n                value: `${data.hoursTracking.completionMetrics.percentageComplete}%`,\n                notes: \"\"\n            },\n            {\n                parameter: \"Burndown Rate\",\n                value: data.hoursTracking.completionMetrics.burndownRate,\n                notes: \"Hours per week\"\n            },\n            {\n                parameter: \"Estimated Weeks Remaining\",\n                value: data.hoursTracking.completionMetrics.estimatedWeeksRemaining,\n                notes: \"\"\n            }\n        ]);\n        // Format cells\n        overviewSheet.getColumn(\"parameter\").font = {\n            bold: true\n        };\n        // Weekly Hours Sheet\n        const weeklyHoursSheet = workbook.addWorksheet(\"Weekly Hours\");\n        weeklyHoursSheet.columns = [\n            {\n                header: \"Week Ending\",\n                key: \"weekEnding\",\n                width: 15\n            },\n            {\n                header: \"Planned Hours\",\n                key: \"hoursPlanned\",\n                width: 15\n            },\n            {\n                header: \"Actual Hours\",\n                key: \"hoursActual\",\n                width: 15\n            },\n            {\n                header: \"Cumulative Planned\",\n                key: \"cumulativePlanned\",\n                width: 20\n            },\n            {\n                header: \"Cumulative Actual\",\n                key: \"cumulativeActual\",\n                width: 20\n            },\n            {\n                header: \"Hours Variance\",\n                key: \"hoursVariance\",\n                width: 15\n            }\n        ];\n        // Add weekly hours data\n        data.hoursTracking.weeklyHours.forEach((week)=>{\n            weeklyHoursSheet.addRow({\n                weekEnding: week.weekEnding,\n                hoursPlanned: week.hoursPlanned,\n                hoursActual: week.hoursActual,\n                cumulativePlanned: week.cumulativePlanned,\n                cumulativeActual: week.cumulativeActual,\n                hoursVariance: week.hoursActual - week.hoursPlanned\n            });\n        });\n        // Format with alternating row colors\n        weeklyHoursSheet.eachRow((row, rowNumber)=>{\n            if (rowNumber > 1) {\n                if (rowNumber % 2) {\n                    row.eachCell({\n                        includeEmpty: true\n                    }, (cell)=>{\n                        cell.fill = {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"F5F5F5\"\n                            }\n                        };\n                    });\n                }\n            } else {\n                // Header row\n                row.eachCell({\n                    includeEmpty: true\n                }, (cell)=>{\n                    cell.font = {\n                        bold: true\n                    };\n                    cell.fill = {\n                        type: \"pattern\",\n                        pattern: \"solid\",\n                        fgColor: {\n                            argb: \"E0E0E0\"\n                        }\n                    };\n                });\n            }\n        });\n        // Worker Hours Sheet\n        if (data.workerHours && data.workerHours.length > 0) {\n            const workerHoursSheet = workbook.addWorksheet(\"Worker Hours\");\n            workerHoursSheet.columns = [\n                {\n                    header: \"Worker Name\",\n                    key: \"workerName\",\n                    width: 15\n                },\n                {\n                    header: \"Week Ending\",\n                    key: \"weekEnding\",\n                    width: 15\n                },\n                {\n                    header: \"Monday\",\n                    key: \"monday\",\n                    width: 10\n                },\n                {\n                    header: \"Tuesday\",\n                    key: \"tuesday\",\n                    width: 10\n                },\n                {\n                    header: \"Wednesday\",\n                    key: \"wednesday\",\n                    width: 10\n                },\n                {\n                    header: \"Thursday\",\n                    key: \"thursday\",\n                    width: 10\n                },\n                {\n                    header: \"Friday\",\n                    key: \"friday\",\n                    width: 10\n                },\n                {\n                    header: \"Total Hours\",\n                    key: \"totalHours\",\n                    width: 15\n                }\n            ];\n            // Add worker hours data\n            data.workerHours.forEach((entry)=>{\n                workerHoursSheet.addRow({\n                    workerName: entry.workerName,\n                    weekEnding: entry.weekEnding,\n                    monday: entry.hours.monday,\n                    tuesday: entry.hours.tuesday,\n                    wednesday: entry.hours.wednesday,\n                    thursday: entry.hours.thursday,\n                    friday: entry.hours.friday,\n                    totalHours: entry.totalHours\n                });\n            });\n            // Format worker hours\n            workerHoursSheet.getRow(1).font = {\n                bold: true\n            };\n            workerHoursSheet.getRow(1).fill = {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: {\n                    argb: \"E0E0E0\"\n                }\n            };\n        }\n        // Task Completion Sheet\n        const taskSheet = workbook.addWorksheet(\"Task Completion\");\n        taskSheet.columns = [\n            {\n                header: \"Task\",\n                key: \"task\",\n                width: 20\n            },\n            {\n                header: \"Planned %\",\n                key: \"planned\",\n                width: 15\n            },\n            {\n                header: \"Actual %\",\n                key: \"actual\",\n                width: 15\n            },\n            {\n                header: \"Variance\",\n                key: \"variance\",\n                width: 15\n            }\n        ];\n        // Add task data\n        data.schedule.forEach((task)=>{\n            taskSheet.addRow({\n                task: task.task,\n                planned: task.Planned,\n                actual: task.Actual,\n                variance: task.Actual - task.Planned\n            });\n        });\n        // Format task sheet\n        taskSheet.getRow(1).font = {\n            bold: true\n        };\n        // Issues Sheet\n        const issuesSheet = workbook.addWorksheet(\"Issues\");\n        issuesSheet.columns = [\n            {\n                header: \"Date\",\n                key: \"date\",\n                width: 15\n            },\n            {\n                header: \"System\",\n                key: \"system\",\n                width: 15\n            },\n            {\n                header: \"Issue\",\n                key: \"issue\",\n                width: 30\n            },\n            {\n                header: \"Impact\",\n                key: \"impact\",\n                width: 20\n            },\n            {\n                header: \"Accountability\",\n                key: \"accountability\",\n                width: 20\n            },\n            {\n                header: \"Consequence\",\n                key: \"consequence\",\n                width: 25\n            }\n        ];\n        // Add issues data\n        data.issues.forEach((issue)=>{\n            issuesSheet.addRow({\n                date: issue.date,\n                system: issue.system,\n                issue: issue.issue,\n                impact: issue.impact,\n                accountability: issue.accountability,\n                consequence: issue.consequence\n            });\n        });\n        // Format issues sheet\n        issuesSheet.getRow(1).font = {\n            bold: true\n        };\n        // Generate Excel file\n        const buffer = await workbook.xlsx.writeBuffer();\n        const duration = performance.now() - startTime;\n        (0,_lib_monitoringService__WEBPACK_IMPORTED_MODULE_1__.trackMetric)(\"excelExportDuration\", duration);\n        (0,_lib_monitoringService__WEBPACK_IMPORTED_MODULE_1__.trackEvent)(\"excelExport\", {\n            sheets: workbook.worksheets.map((ws)=>ws.name),\n            rows: {\n                weekly: data.hoursTracking.weeklyHours.length,\n                workers: data.workerHours ? data.workerHours.length : 0,\n                tasks: data.schedule.length,\n                issues: data.issues.length\n            }\n        });\n        // Set headers and send file\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=Higuera-Project-Export-${new Date().toISOString().split(\"T\")[0]}.xlsx`);\n        res.status(200).send(Buffer.from(buffer));\n    } catch (error) {\n        console.error(\"Excel export error:\", error);\n        (0,_lib_monitoringService__WEBPACK_IMPORTED_MODULE_1__.trackEvent)(\"excelExportError\", {\n            message: error.message,\n            stack: error.stack\n        });\n        res.status(500).json({\n            error: error.message || \"Failed to export Excel file\"\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_middleware__WEBPACK_IMPORTED_MODULE_0__.withApiAuth)(handler));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlDLE1BQU0sQ0FBQyxLQUFLc0gsSUFBSSxDQUFDQyxPQUFPQyxJQUFJLENBQUNsQjtJQUNuQyxFQUFFLE9BQU8zRyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyx1QkFBdUJBO1FBRXJDTixrRUFBVUEsQ0FBQyxvQkFBb0I7WUFDN0JvSSxTQUFTOUgsTUFBTThILE9BQU87WUFDdEJDLE9BQU8vSCxNQUFNK0gsS0FBSztRQUNwQjtRQUVBM0gsSUFBSUMsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFTixPQUFPQSxNQUFNOEgsT0FBTyxJQUFJO1FBQThCO0lBQy9FO0FBQ0Y7QUFFQSxpRUFBZXJJLDREQUFXQSxDQUFDUyxRQUFRQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGlndWVyYWF6dXJlZnVuY3Rpb24vLi9wYWdlcy9hcGkvZXhwb3J0RXhjZWwuanM/ZjM5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB3aXRoQXBpQXV0aCB9IGZyb20gJy4uLy4uL2xpYi9taWRkbGV3YXJlJztcbmltcG9ydCB7IHRyYWNrRXZlbnQsIHRyYWNrTWV0cmljIH0gZnJvbSAnLi4vLi4vbGliL21vbml0b3JpbmdTZXJ2aWNlJztcblxuLy8gRGVmaW5lIHNlcnZlci1vbmx5IG1vZHVsZXMgdGhhdCB3aWxsIGJlIGltcG9ydGVkIGNvbmRpdGlvbmFsbHlcbmxldCBmcyA9IG51bGw7XG5sZXQgcGF0aCA9IG51bGw7XG5sZXQgRXhjZWxKUyA9IG51bGw7XG5cbi8vIE9ubHkgaW1wb3J0IHNlcnZlci1zaWRlIG1vZHVsZXMgd2hlbiBydW5uaW5nIG9uIHRoZSBzZXJ2ZXJcbmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICB0cnkge1xuICAgIGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgICBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuICAgIEV4Y2VsSlMgPSByZXF1aXJlKCdleGNlbGpzJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW1wb3J0aW5nIHNlcnZlci1zaWRlIG1vZHVsZXM6JywgZXJyb3IpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgLy8gVGhpcyBpcyBhbiBBUEkgcm91dGUsIHdoaWNoIG9ubHkgcnVucyBvbiB0aGUgc2VydmVyIHNpZGVcbiAgLy8gQnV0IHdlIHN0aWxsIG5lZWQgdG8gZW5zdXJlIHRoZSBpbXBvcnRzIHdvcmtlZCBjb3JyZWN0bHlcbiAgaWYgKCFmcyB8fCAhcGF0aCB8fCAhRXhjZWxKUykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnU2VydmVyLXNpZGUgbW9kdWxlcyBub3QgYXZhaWxhYmxlJyB9KTtcbiAgfVxuXG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gIHRyeSB7XG4gICAgLy8gUmVhZCB0aGUgZGF0YS5qc29uIGZpbGVcbiAgICBjb25zdCBkYXRhUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ2RhdGEnLCAnZGF0YS5qc29uJyk7XG4gICAgY29uc3QgZGF0YVJhdyA9IGZzLnJlYWRGaWxlU3luYyhkYXRhUGF0aCwgJ3V0ZjgnKTtcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShkYXRhUmF3KTtcbiAgICBcbiAgICAvLyBDcmVhdGUgYSBuZXcgRXhjZWwgd29ya2Jvb2tcbiAgICBjb25zdCB3b3JrYm9vayA9IG5ldyBFeGNlbEpTLldvcmtib29rKCk7XG4gICAgd29ya2Jvb2suY3JlYXRvciA9ICdIaWd1ZXJhIFByb2plY3QgRGFzaGJvYXJkJztcbiAgICB3b3JrYm9vay5sYXN0TW9kaWZpZWRCeSA9ICdBUEknO1xuICAgIHdvcmtib29rLmNyZWF0ZWQgPSBuZXcgRGF0ZSgpO1xuICAgIHdvcmtib29rLm1vZGlmaWVkID0gbmV3IERhdGUoKTtcbiAgICBcbiAgICAvLyBQcm9qZWN0IE92ZXJ2aWV3IFNoZWV0XG4gICAgY29uc3Qgb3ZlcnZpZXdTaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCgnUHJvamVjdCBPdmVydmlldycpO1xuICAgIG92ZXJ2aWV3U2hlZXQuY29sdW1ucyA9IFtcbiAgICAgIHsgaGVhZGVyOiAnUGFyYW1ldGVyJywga2V5OiAncGFyYW1ldGVyJywgd2lkdGg6IDI1IH0sXG4gICAgICB7IGhlYWRlcjogJ1ZhbHVlJywga2V5OiAndmFsdWUnLCB3aWR0aDogMTUgfSxcbiAgICAgIHsgaGVhZGVyOiAnTm90ZXMnLCBrZXk6ICdub3RlcycsIHdpZHRoOiA0MCB9XG4gICAgXTtcbiAgICBcbiAgICAvLyBBZGQgcHJvamVjdCBvdmVydmlldyBkYXRhXG4gICAgb3ZlcnZpZXdTaGVldC5hZGRSb3dzKFtcbiAgICAgIHsgcGFyYW1ldGVyOiAnUHJvamVjdCBTdGFydCcsIHZhbHVlOiBkYXRhLmhvdXJzVHJhY2tpbmcuc3RhcnREYXRlLCBub3RlczogJycgfSxcbiAgICAgIHsgcGFyYW1ldGVyOiAnUGxhbm5lZCBFbmQgRGF0ZScsIHZhbHVlOiBkYXRhLmhvdXJzVHJhY2tpbmcucGxhbm5lZEVuZERhdGUsIG5vdGVzOiAnJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdQcm9qZWN0ZWQgRW5kIERhdGUnLCB2YWx1ZTogZGF0YS5ob3Vyc1RyYWNraW5nLnByb2plY3RlZEVuZERhdGUsIG5vdGVzOiAnQmFzZWQgb24gY3VycmVudCBidXJuZG93biByYXRlJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdUb3RhbCBCdWRnZXQnLCB2YWx1ZTogZGF0YS5rcGlzLnRvdGFsQnVkZ2V0LCBub3RlczogJ1VTRCcgfSxcbiAgICAgIHsgcGFyYW1ldGVyOiAnU3BlbnQnLCB2YWx1ZTogZGF0YS5rcGlzLnNwZW50LCBub3RlczogJ1VTRCcgfSxcbiAgICAgIHsgcGFyYW1ldGVyOiAnUmVtYWluaW5nJywgdmFsdWU6IGRhdGEua3Bpcy5yZW1haW5pbmcsIG5vdGVzOiAnVVNEJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdPdmVycnVuIFJpc2snLCB2YWx1ZTogZGF0YS5rcGlzLnJpc2ssIG5vdGVzOiAnJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdUb3RhbCBIb3VycyBBbGxvY2F0ZWQnLCB2YWx1ZTogZGF0YS5ob3Vyc1RyYWNraW5nLnRvdGFsSG91cnNBbGxvY2F0ZWQsIG5vdGVzOiAnJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdUb3RhbCBIb3VycyBVc2VkJywgdmFsdWU6IGRhdGEuaG91cnNUcmFja2luZy50b3RhbEhvdXJzVXNlZCwgbm90ZXM6ICcnIH0sXG4gICAgICB7IHBhcmFtZXRlcjogJ0hvdXJzIFJlbWFpbmluZycsIHZhbHVlOiBkYXRhLmhvdXJzVHJhY2tpbmcuY29tcGxldGlvbk1ldHJpY3MuaG91cnNSZW1haW5pbmcsIG5vdGVzOiAnJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdQZXJjZW50IENvbXBsZXRlJywgdmFsdWU6IGAke2RhdGEuaG91cnNUcmFja2luZy5jb21wbGV0aW9uTWV0cmljcy5wZXJjZW50YWdlQ29tcGxldGV9JWAsIG5vdGVzOiAnJyB9LFxuICAgICAgeyBwYXJhbWV0ZXI6ICdCdXJuZG93biBSYXRlJywgdmFsdWU6IGRhdGEuaG91cnNUcmFja2luZy5jb21wbGV0aW9uTWV0cmljcy5idXJuZG93blJhdGUsIG5vdGVzOiAnSG91cnMgcGVyIHdlZWsnIH0sXG4gICAgICB7IHBhcmFtZXRlcjogJ0VzdGltYXRlZCBXZWVrcyBSZW1haW5pbmcnLCB2YWx1ZTogZGF0YS5ob3Vyc1RyYWNraW5nLmNvbXBsZXRpb25NZXRyaWNzLmVzdGltYXRlZFdlZWtzUmVtYWluaW5nLCBub3RlczogJycgfVxuICAgIF0pO1xuICAgIFxuICAgIC8vIEZvcm1hdCBjZWxsc1xuICAgIG92ZXJ2aWV3U2hlZXQuZ2V0Q29sdW1uKCdwYXJhbWV0ZXInKS5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgXG4gICAgLy8gV2Vla2x5IEhvdXJzIFNoZWV0XG4gICAgY29uc3Qgd2Vla2x5SG91cnNTaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCgnV2Vla2x5IEhvdXJzJyk7XG4gICAgd2Vla2x5SG91cnNTaGVldC5jb2x1bW5zID0gW1xuICAgICAgeyBoZWFkZXI6ICdXZWVrIEVuZGluZycsIGtleTogJ3dlZWtFbmRpbmcnLCB3aWR0aDogMTUgfSxcbiAgICAgIHsgaGVhZGVyOiAnUGxhbm5lZCBIb3VycycsIGtleTogJ2hvdXJzUGxhbm5lZCcsIHdpZHRoOiAxNSB9LFxuICAgICAgeyBoZWFkZXI6ICdBY3R1YWwgSG91cnMnLCBrZXk6ICdob3Vyc0FjdHVhbCcsIHdpZHRoOiAxNSB9LFxuICAgICAgeyBoZWFkZXI6ICdDdW11bGF0aXZlIFBsYW5uZWQnLCBrZXk6ICdjdW11bGF0aXZlUGxhbm5lZCcsIHdpZHRoOiAyMCB9LFxuICAgICAgeyBoZWFkZXI6ICdDdW11bGF0aXZlIEFjdHVhbCcsIGtleTogJ2N1bXVsYXRpdmVBY3R1YWwnLCB3aWR0aDogMjAgfSxcbiAgICAgIHsgaGVhZGVyOiAnSG91cnMgVmFyaWFuY2UnLCBrZXk6ICdob3Vyc1ZhcmlhbmNlJywgd2lkdGg6IDE1IH1cbiAgICBdO1xuICAgIFxuICAgIC8vIEFkZCB3ZWVrbHkgaG91cnMgZGF0YVxuICAgIGRhdGEuaG91cnNUcmFja2luZy53ZWVrbHlIb3Vycy5mb3JFYWNoKHdlZWsgPT4ge1xuICAgICAgd2Vla2x5SG91cnNTaGVldC5hZGRSb3coe1xuICAgICAgICB3ZWVrRW5kaW5nOiB3ZWVrLndlZWtFbmRpbmcsXG4gICAgICAgIGhvdXJzUGxhbm5lZDogd2Vlay5ob3Vyc1BsYW5uZWQsXG4gICAgICAgIGhvdXJzQWN0dWFsOiB3ZWVrLmhvdXJzQWN0dWFsLFxuICAgICAgICBjdW11bGF0aXZlUGxhbm5lZDogd2Vlay5jdW11bGF0aXZlUGxhbm5lZCxcbiAgICAgICAgY3VtdWxhdGl2ZUFjdHVhbDogd2Vlay5jdW11bGF0aXZlQWN0dWFsLFxuICAgICAgICBob3Vyc1ZhcmlhbmNlOiB3ZWVrLmhvdXJzQWN0dWFsIC0gd2Vlay5ob3Vyc1BsYW5uZWRcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIFxuICAgIC8vIEZvcm1hdCB3aXRoIGFsdGVybmF0aW5nIHJvdyBjb2xvcnNcbiAgICB3ZWVrbHlIb3Vyc1NoZWV0LmVhY2hSb3coKHJvdywgcm93TnVtYmVyKSA9PiB7XG4gICAgICBpZiAocm93TnVtYmVyID4gMSkge1xuICAgICAgICBpZiAocm93TnVtYmVyICUgMikge1xuICAgICAgICAgIHJvdy5lYWNoQ2VsbCh7IGluY2x1ZGVFbXB0eTogdHJ1ZSB9LCBjZWxsID0+IHtcbiAgICAgICAgICAgIGNlbGwuZmlsbCA9IHtcbiAgICAgICAgICAgICAgdHlwZTogJ3BhdHRlcm4nLFxuICAgICAgICAgICAgICBwYXR0ZXJuOiAnc29saWQnLFxuICAgICAgICAgICAgICBmZ0NvbG9yOiB7IGFyZ2I6ICdGNUY1RjUnIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEhlYWRlciByb3dcbiAgICAgICAgcm93LmVhY2hDZWxsKHsgaW5jbHVkZUVtcHR5OiB0cnVlIH0sIGNlbGwgPT4ge1xuICAgICAgICAgIGNlbGwuZm9udCA9IHsgYm9sZDogdHJ1ZSB9O1xuICAgICAgICAgIGNlbGwuZmlsbCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdwYXR0ZXJuJyxcbiAgICAgICAgICAgIHBhdHRlcm46ICdzb2xpZCcsXG4gICAgICAgICAgICBmZ0NvbG9yOiB7IGFyZ2I6ICdFMEUwRTAnIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICAvLyBXb3JrZXIgSG91cnMgU2hlZXRcbiAgICBpZiAoZGF0YS53b3JrZXJIb3VycyAmJiBkYXRhLndvcmtlckhvdXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHdvcmtlckhvdXJzU2hlZXQgPSB3b3JrYm9vay5hZGRXb3Jrc2hlZXQoJ1dvcmtlciBIb3VycycpO1xuICAgICAgd29ya2VySG91cnNTaGVldC5jb2x1bW5zID0gW1xuICAgICAgICB7IGhlYWRlcjogJ1dvcmtlciBOYW1lJywga2V5OiAnd29ya2VyTmFtZScsIHdpZHRoOiAxNSB9LFxuICAgICAgICB7IGhlYWRlcjogJ1dlZWsgRW5kaW5nJywga2V5OiAnd2Vla0VuZGluZycsIHdpZHRoOiAxNSB9LFxuICAgICAgICB7IGhlYWRlcjogJ01vbmRheScsIGtleTogJ21vbmRheScsIHdpZHRoOiAxMCB9LFxuICAgICAgICB7IGhlYWRlcjogJ1R1ZXNkYXknLCBrZXk6ICd0dWVzZGF5Jywgd2lkdGg6IDEwIH0sXG4gICAgICAgIHsgaGVhZGVyOiAnV2VkbmVzZGF5Jywga2V5OiAnd2VkbmVzZGF5Jywgd2lkdGg6IDEwIH0sXG4gICAgICAgIHsgaGVhZGVyOiAnVGh1cnNkYXknLCBrZXk6ICd0aHVyc2RheScsIHdpZHRoOiAxMCB9LFxuICAgICAgICB7IGhlYWRlcjogJ0ZyaWRheScsIGtleTogJ2ZyaWRheScsIHdpZHRoOiAxMCB9LFxuICAgICAgICB7IGhlYWRlcjogJ1RvdGFsIEhvdXJzJywga2V5OiAndG90YWxIb3VycycsIHdpZHRoOiAxNSB9XG4gICAgICBdO1xuICAgICAgXG4gICAgICAvLyBBZGQgd29ya2VyIGhvdXJzIGRhdGFcbiAgICAgIGRhdGEud29ya2VySG91cnMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICAgIHdvcmtlckhvdXJzU2hlZXQuYWRkUm93KHtcbiAgICAgICAgICB3b3JrZXJOYW1lOiBlbnRyeS53b3JrZXJOYW1lLFxuICAgICAgICAgIHdlZWtFbmRpbmc6IGVudHJ5LndlZWtFbmRpbmcsXG4gICAgICAgICAgbW9uZGF5OiBlbnRyeS5ob3Vycy5tb25kYXksXG4gICAgICAgICAgdHVlc2RheTogZW50cnkuaG91cnMudHVlc2RheSxcbiAgICAgICAgICB3ZWRuZXNkYXk6IGVudHJ5LmhvdXJzLndlZG5lc2RheSxcbiAgICAgICAgICB0aHVyc2RheTogZW50cnkuaG91cnMudGh1cnNkYXksXG4gICAgICAgICAgZnJpZGF5OiBlbnRyeS5ob3Vycy5mcmlkYXksXG4gICAgICAgICAgdG90YWxIb3VyczogZW50cnkudG90YWxIb3Vyc1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBGb3JtYXQgd29ya2VyIGhvdXJzXG4gICAgICB3b3JrZXJIb3Vyc1NoZWV0LmdldFJvdygxKS5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgICB3b3JrZXJIb3Vyc1NoZWV0LmdldFJvdygxKS5maWxsID0ge1xuICAgICAgICB0eXBlOiAncGF0dGVybicsXG4gICAgICAgIHBhdHRlcm46ICdzb2xpZCcsXG4gICAgICAgIGZnQ29sb3I6IHsgYXJnYjogJ0UwRTBFMCcgfVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gVGFzayBDb21wbGV0aW9uIFNoZWV0XG4gICAgY29uc3QgdGFza1NoZWV0ID0gd29ya2Jvb2suYWRkV29ya3NoZWV0KCdUYXNrIENvbXBsZXRpb24nKTtcbiAgICB0YXNrU2hlZXQuY29sdW1ucyA9IFtcbiAgICAgIHsgaGVhZGVyOiAnVGFzaycsIGtleTogJ3Rhc2snLCB3aWR0aDogMjAgfSxcbiAgICAgIHsgaGVhZGVyOiAnUGxhbm5lZCAlJywga2V5OiAncGxhbm5lZCcsIHdpZHRoOiAxNSB9LFxuICAgICAgeyBoZWFkZXI6ICdBY3R1YWwgJScsIGtleTogJ2FjdHVhbCcsIHdpZHRoOiAxNSB9LFxuICAgICAgeyBoZWFkZXI6ICdWYXJpYW5jZScsIGtleTogJ3ZhcmlhbmNlJywgd2lkdGg6IDE1IH1cbiAgICBdO1xuICAgIFxuICAgIC8vIEFkZCB0YXNrIGRhdGFcbiAgICBkYXRhLnNjaGVkdWxlLmZvckVhY2godGFzayA9PiB7XG4gICAgICB0YXNrU2hlZXQuYWRkUm93KHtcbiAgICAgICAgdGFzazogdGFzay50YXNrLFxuICAgICAgICBwbGFubmVkOiB0YXNrLlBsYW5uZWQsXG4gICAgICAgIGFjdHVhbDogdGFzay5BY3R1YWwsXG4gICAgICAgIHZhcmlhbmNlOiB0YXNrLkFjdHVhbCAtIHRhc2suUGxhbm5lZFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gRm9ybWF0IHRhc2sgc2hlZXRcbiAgICB0YXNrU2hlZXQuZ2V0Um93KDEpLmZvbnQgPSB7IGJvbGQ6IHRydWUgfTtcbiAgICBcbiAgICAvLyBJc3N1ZXMgU2hlZXRcbiAgICBjb25zdCBpc3N1ZXNTaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCgnSXNzdWVzJyk7XG4gICAgaXNzdWVzU2hlZXQuY29sdW1ucyA9IFtcbiAgICAgIHsgaGVhZGVyOiAnRGF0ZScsIGtleTogJ2RhdGUnLCB3aWR0aDogMTUgfSxcbiAgICAgIHsgaGVhZGVyOiAnU3lzdGVtJywga2V5OiAnc3lzdGVtJywgd2lkdGg6IDE1IH0sXG4gICAgICB7IGhlYWRlcjogJ0lzc3VlJywga2V5OiAnaXNzdWUnLCB3aWR0aDogMzAgfSxcbiAgICAgIHsgaGVhZGVyOiAnSW1wYWN0Jywga2V5OiAnaW1wYWN0Jywgd2lkdGg6IDIwIH0sXG4gICAgICB7IGhlYWRlcjogJ0FjY291bnRhYmlsaXR5Jywga2V5OiAnYWNjb3VudGFiaWxpdHknLCB3aWR0aDogMjAgfSxcbiAgICAgIHsgaGVhZGVyOiAnQ29uc2VxdWVuY2UnLCBrZXk6ICdjb25zZXF1ZW5jZScsIHdpZHRoOiAyNSB9XG4gICAgXTtcbiAgICBcbiAgICAvLyBBZGQgaXNzdWVzIGRhdGFcbiAgICBkYXRhLmlzc3Vlcy5mb3JFYWNoKGlzc3VlID0+IHtcbiAgICAgIGlzc3Vlc1NoZWV0LmFkZFJvdyh7XG4gICAgICAgIGRhdGU6IGlzc3VlLmRhdGUsXG4gICAgICAgIHN5c3RlbTogaXNzdWUuc3lzdGVtLFxuICAgICAgICBpc3N1ZTogaXNzdWUuaXNzdWUsXG4gICAgICAgIGltcGFjdDogaXNzdWUuaW1wYWN0LFxuICAgICAgICBhY2NvdW50YWJpbGl0eTogaXNzdWUuYWNjb3VudGFiaWxpdHksXG4gICAgICAgIGNvbnNlcXVlbmNlOiBpc3N1ZS5jb25zZXF1ZW5jZVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gRm9ybWF0IGlzc3VlcyBzaGVldFxuICAgIGlzc3Vlc1NoZWV0LmdldFJvdygxKS5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgRXhjZWwgZmlsZVxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHdvcmtib29rLnhsc3gud3JpdGVCdWZmZXIoKTtcbiAgICBcbiAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIHRyYWNrTWV0cmljKCdleGNlbEV4cG9ydER1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgIFxuICAgIHRyYWNrRXZlbnQoJ2V4Y2VsRXhwb3J0Jywge1xuICAgICAgc2hlZXRzOiB3b3JrYm9vay53b3Jrc2hlZXRzLm1hcCh3cyA9PiB3cy5uYW1lKSxcbiAgICAgIHJvd3M6IHtcbiAgICAgICAgd2Vla2x5OiBkYXRhLmhvdXJzVHJhY2tpbmcud2Vla2x5SG91cnMubGVuZ3RoLFxuICAgICAgICB3b3JrZXJzOiBkYXRhLndvcmtlckhvdXJzID8gZGF0YS53b3JrZXJIb3Vycy5sZW5ndGggOiAwLFxuICAgICAgICB0YXNrczogZGF0YS5zY2hlZHVsZS5sZW5ndGgsXG4gICAgICAgIGlzc3VlczogZGF0YS5pc3N1ZXMubGVuZ3RoXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgaGVhZGVycyBhbmQgc2VuZCBmaWxlXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0Jyk7XG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1EaXNwb3NpdGlvbicsIGBhdHRhY2htZW50OyBmaWxlbmFtZT1IaWd1ZXJhLVByb2plY3QtRXhwb3J0LSR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19Lnhsc3hgKTtcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChCdWZmZXIuZnJvbShidWZmZXIpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFeGNlbCBleHBvcnQgZXJyb3I6JywgZXJyb3IpO1xuICAgIFxuICAgIHRyYWNrRXZlbnQoJ2V4Y2VsRXhwb3J0RXJyb3InLCB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgc3RhY2s6IGVycm9yLnN0YWNrXG4gICAgfSk7XG4gICAgXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGV4cG9ydCBFeGNlbCBmaWxlJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB3aXRoQXBpQXV0aChoYW5kbGVyKTsiXSwibmFtZXMiOlsid2l0aEFwaUF1dGgiLCJ0cmFja0V2ZW50IiwidHJhY2tNZXRyaWMiLCJmcyIsInBhdGgiLCJFeGNlbEpTIiwicmVxdWlyZSIsImVycm9yIiwiY29uc29sZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzdGF0dXMiLCJqc29uIiwibWV0aG9kIiwic3RhcnRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJkYXRhUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZGF0YVJhdyIsInJlYWRGaWxlU3luYyIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJ3b3JrYm9vayIsIldvcmtib29rIiwiY3JlYXRvciIsImxhc3RNb2RpZmllZEJ5IiwiY3JlYXRlZCIsIkRhdGUiLCJtb2RpZmllZCIsIm92ZXJ2aWV3U2hlZXQiLCJhZGRXb3Jrc2hlZXQiLCJjb2x1bW5zIiwiaGVhZGVyIiwia2V5Iiwid2lkdGgiLCJhZGRSb3dzIiwicGFyYW1ldGVyIiwidmFsdWUiLCJob3Vyc1RyYWNraW5nIiwic3RhcnREYXRlIiwibm90ZXMiLCJwbGFubmVkRW5kRGF0ZSIsInByb2plY3RlZEVuZERhdGUiLCJrcGlzIiwidG90YWxCdWRnZXQiLCJzcGVudCIsInJlbWFpbmluZyIsInJpc2siLCJ0b3RhbEhvdXJzQWxsb2NhdGVkIiwidG90YWxIb3Vyc1VzZWQiLCJjb21wbGV0aW9uTWV0cmljcyIsImhvdXJzUmVtYWluaW5nIiwicGVyY2VudGFnZUNvbXBsZXRlIiwiYnVybmRvd25SYXRlIiwiZXN0aW1hdGVkV2Vla3NSZW1haW5pbmciLCJnZXRDb2x1bW4iLCJmb250IiwiYm9sZCIsIndlZWtseUhvdXJzU2hlZXQiLCJ3ZWVrbHlIb3VycyIsImZvckVhY2giLCJ3ZWVrIiwiYWRkUm93Iiwid2Vla0VuZGluZyIsImhvdXJzUGxhbm5lZCIsImhvdXJzQWN0dWFsIiwiY3VtdWxhdGl2ZVBsYW5uZWQiLCJjdW11bGF0aXZlQWN0dWFsIiwiaG91cnNWYXJpYW5jZSIsImVhY2hSb3ciLCJyb3ciLCJyb3dOdW1iZXIiLCJlYWNoQ2VsbCIsImluY2x1ZGVFbXB0eSIsImNlbGwiLCJmaWxsIiwidHlwZSIsInBhdHRlcm4iLCJmZ0NvbG9yIiwiYXJnYiIsIndvcmtlckhvdXJzIiwibGVuZ3RoIiwid29ya2VySG91cnNTaGVldCIsImVudHJ5Iiwid29ya2VyTmFtZSIsIm1vbmRheSIsImhvdXJzIiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5IiwidG90YWxIb3VycyIsImdldFJvdyIsInRhc2tTaGVldCIsInNjaGVkdWxlIiwidGFzayIsInBsYW5uZWQiLCJQbGFubmVkIiwiYWN0dWFsIiwiQWN0dWFsIiwidmFyaWFuY2UiLCJpc3N1ZXNTaGVldCIsImlzc3VlcyIsImlzc3VlIiwiZGF0ZSIsInN5c3RlbSIsImltcGFjdCIsImFjY291bnRhYmlsaXR5IiwiY29uc2VxdWVuY2UiLCJidWZmZXIiLCJ4bHN4Iiwid3JpdGVCdWZmZXIiLCJkdXJhdGlvbiIsInNoZWV0cyIsIndvcmtzaGVldHMiLCJtYXAiLCJ3cyIsIm5hbWUiLCJyb3dzIiwid2Vla2x5Iiwid29ya2VycyIsInRhc2tzIiwic2V0SGVhZGVyIiwidG9JU09TdHJpbmciLCJzcGxpdCIsInNlbmQiLCJCdWZmZXIiLCJmcm9tIiwibWVzc2FnZSIsInN0YWNrIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/exportExcel.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2FexportExcel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2FexportExcel.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();